!function(b,d,e,f){XenForo.PostMacros=function(a){this.__construct(a)};XenForo.PostMacros.prototype={__construct:function(a){console.log(a);this.$macros=a;this.$macros.data("editorid")?(this.$macros.bind("change",b.context(this,"macroSelected")),this.updateVars(),this.titleField=b("#ctrl_title_thread_create"),this.noForm=!1):console.error("Invalid Editor Id!")},updateVars:function(){var a=b("form"),c=this;jQuery.each(a,function(a,b){if($editor=XenForo.getEditorInForm(b,"#"+c.escape(c.$macros.data("editorid"))+
	"_html"))return c.$editor=$editor,c.$form=b,!1});this.$editor||jQuery.each(a,function(a,b){if($editor=XenForo.getEditorInForm(b,"#"+c.escape(c.$macros.data("editorid"))))return c.$editor=$editor,c.$form=b,!1});this.$editor?this.type="undefined"==typeof this.$editor.val?"html":"plain":console.warn("Post Macros: Unable to find editor! Post macros isn't going to work...")},macroSelected:function(){if(!this.noForm){var a=this.$macros.val();0!=a&&(this.updateVars(),XenForo.ajax("post-macros/use",{macro_id:a,
	render:"html"==this.type?1:0,type:this.$macros.find(":selected").data("type"),formAction:this.$macros.closest("form").attr("action")},b.context(this,"successCallback")))}},successCallback:function(a,c){if(!this.noForm)if(a.templateHtml)this.$macros.val(0),XenForo.ajaxError(a);else{if(a.macroContent)switch(this.type){case "html":try{this.$editor.insertHtml(a.macroContent.toString())}catch(d){this.$editor.execCommand("mceInsertContent",!1,a.macroContent.toString())}break;case "plain":this.$editor.val(this.$editor.val()+
a.macroContent.toString().replace(/<br \/>/g,""))}a.threadTitle&&this.titleField&&this.titleField.val(a.threadTitle);a.lockThread&&(console.log("Locking thread"),b('<input type="hidden" name="set_locked" value="1" />').appendTo(this.$form));a.threadPrefix&&(console.log("Setting prefix..."),b('<input type="hidden" name="set_prefix" value="'+a.threadPrefix+'" />').appendTo(this.$form));this.$macros.val(0)}},escape:function(a){return a.replace(/(:|\.|\[|\]|,)/g,"\\$1")}};XenForo.register(".MacroSelect",
	"XenForo.PostMacros")}(jQuery,this,document);