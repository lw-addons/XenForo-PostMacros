!function(d,h,g,k){XenForo.MacrosButtons=function(a){this.__construct(a)};XenForo.MacrosButtons.prototype={__construct:function(a){this.textarea=a;d(g).bind({EditorInit:d.context(this,"editorInitFunc")})},editorInitFunc:function(a,b){this.$xenEditor=b;b.$textarea[0]==this.textarea[0]&&(b.config.buttonsCustom.insert.dropdown.macros_button={callback:d.context(this,"macrosButtonCallback"),title:this.$xenEditor.editor.getText("liam_postMacros_macro"),className:"icon insertMacro"})},macrosButtonCallback:function(a){var b=
	this;a.modalInit(this.$xenEditor.editor.getText("liam_postMacros_insert_macro"),{url:this.$xenEditor.editor.dialogUrl+"&dialog=liam_postmacros"},600,d.proxy(function(){d("#liam_postmacros_insert_btn").click(function(c){c.preventDefault();b.insertMacro(c,a)});setTimeout(function(){b.$macroSelect=d("#liam_postmacros_select");b.$macroSelect.focus()},100)}),a)},insertMacro:function(a,b){var c=this;c.macroForm=b.$el.closest("form");var e=c.$macroSelect.val();0!=e&&XenForo.ajax("post-macros/use",{macro_id:e,
	render:1,type:c.$macroSelect.find(":selected").data("type"),formAction:c.macroForm.attr("action")},function(a,e){a.macroContent&&b.execCommand("inserthtml",a.macroContent.toString());var f=d("#ctrl_title_thread_create");a.threadTitle&&f&&f.val(a.threadTitle);a.lockThread&&(console.log("Locking thread"),d('<input type="hidden" name="set_locked" value="1" />').appendTo(c.macroForm),console.log(c.macroForm));a.threadPrefix&&(console.log("Setting prefix..."),d('<input type="hidden" name="set_prefix" value="'+
	a.threadPrefix+'" />').appendTo(c.macroForm));b.syncCode();b.modalClose()})},escape:function(a){return a.replace(/(:|\.|\[|\]|,)/g,"\\$1")}};XenForo.register("textarea.BbCodeWysiwygEditor","XenForo.MacrosButtons")}(jQuery,this,document);
