!function(c,g,f,h){XenForo.MacrosButtons=function(b){this.__construct(b)};XenForo.MacrosButtons.prototype={__construct:function(b){this.textarea=b;c(f).bind({EditorInit:c.context(this,"editorInitFunc")})},editorInitFunc:function(b,a){this.$xenEditor=a;var e=this;if(a.$textarea[0]==this.textarea[0]&&a.editor.options.macros){var d={"user-0":{title:"User Macros",style:"opacity: 0.6; text-decoration: underline;"}};c.each(a.editor.options.macros.user,function(a,b){d["user-"+a]={title:b.title,callback:c.context(e,
		"insertMacroInternal")}});d["admin-0"]={title:"Admin Macros",style:"opacity: 0.6; text-decoration: underline;"};c.each(a.editor.options.macros.admin,function(a,b){d["admin-"+a]={title:b.title,callback:c.context(e,"insertMacroInternal")}});console.log(a.editor.options.macrosMode);switch(a.editor.options.macrosMode){case "insert-modal":a.config.buttonsCustom.insert.dropdown.macros_button={callback:c.context(this,"macrosButtonCallback"),title:this.$xenEditor.editor.getText("liam_postMacros_macro"),className:"icon insertMacro"};
	break;case "modal":a.config.buttons.push(["macros_button"]);a.config.buttonsCustom.macros_button={callback:c.context(this,"macrosButtonCallback"),title:this.$xenEditor.editor.getText("liam_postMacros_insert_macro"),className:"icon insertMacro"};break;case "embedded":a.config.buttons.push(["macros_button"]);a.config.buttonsCustom.macros_button={func:"show",title:this.$xenEditor.editor.getText("liam_postMacros_insert_macro"),dropdown:d};break;default:console.error("Invalid macros mode!")}}},insertMacroInternal:function(b,
																																																																																																																																			   a,e,d){"undefined"===typeof d&&(a=e.split("-"),d=a[0],e=a[1]);XenForo.ajax("post-macros/use",{macro_id:e,render:1,type:d,formAction:b.$el.closest("form").attr("action")},function(a,e){a.macroContent&&b.execCommand("inserthtml",a.macroContent.toString());var d=c("#ctrl_title_thread_create");a.threadTitle&&d&&d.val(a.threadTitle);a.lockThread&&(console.log("Locking thread"),c('<input type="hidden" name="set_locked" value="1" />').appendTo(self.macroForm),console.log(self.macroForm));a.threadPrefix&&
(console.log("Setting prefix..."),c('<input type="hidden" name="set_prefix" value="'+a.threadPrefix+'" />').appendTo(self.macroForm));b.syncCode();b.modalClose()})},macrosButtonCallback:function(b){var a=this;b.modalInit(this.$xenEditor.editor.getText("liam_postMacros_insert_macro"),{url:this.$xenEditor.editor.dialogUrl+"&dialog=liam_postmacros"},600,c.proxy(function(){c("#liam_postmacros_insert_btn").click(function(c){c.preventDefault();a.insertMacro(c,b)});setTimeout(function(){a.$macroSelect=c("#liam_postmacros_select");
	a.$macroSelect.focus()},100)}),b)},insertMacro:function(b,a){this.macroForm=a.$el.closest("form");var c=this.$macroSelect.val();0!=c&&this.insertMacroInternal(a,b,c,this.$macroSelect.find(":selected").data("type"))},escape:function(b){return b.replace(/(:|\.|\[|\]|,)/g,"\\$1")}};XenForo.register("textarea.BbCodeWysiwygEditor","XenForo.MacrosButtons")}(jQuery,this,document);
