!function(b,d,e,f){XenForo.Macros=function(a){this.__construct(a)};XenForo.Macros.prototype={__construct:function(a){this.$macros=a;this.$macros.bind("change",b.context(this,"macroSelected"));this.updateVars();this.titleField=b("#ctrl_title_thread_create");this.noForm=!1},updateVars:function(){$forms=b("form");var a=this;jQuery.each($forms,function(b,c){if($editor=XenForo.getEditorInForm(c))return a.$editor=$editor,a.$form=c,!1});delete a;this.$editor||(console.warn("Unable to find form to insert array into!"),
	this.noForm=!0);this.type="undefined"==typeof this.$editor.val?"html":"plain"},macroSelected:function(){if(!this.noForm){var a=this.$macros.val();0!=a&&(this.updateVars(),XenForo.ajax("macros/use",{macro_id:a,render:"html"==this.type?1:0,type:this.$macros.find(":selected").data("type"),formAction:this.$macros.closest("form").attr("action")},b.context(this,"successCallback"),{type:"GET"}))}},successCallback:function(a,d){if(!this.noForm)if(a.templateHtml)this.$macros.val(0),XenForo.createOverlay(null,
	a.templateHtml,{title:XenForo.phrases.error}).xfShow();else{if(a.macroContent)switch(this.type){case "html":try{this.$editor.insertHtml(a.macroContent.toString())}catch(c){this.editor.execCommand("mceInsertContent",!1,a.macroContent.toString())}break;case "plain":this.$editor.val(this.$editor.val()+a.macroContent.toString().replace(/<br \/>/g,""))}a.threadTitle&&this.titleField&&this.titleField.val(a.threadTitle);a.lockThread&&(b('<input type="hidden" name="_set[discussion_open]" value="1" />').appendTo(this.$form),
	b('<input type="hidden" name="discussion_open" value="0" />').appendTo(this.$form));a.applyPrefix&&b('<input type="hidden" name="apply_prefix" value="'+a.applyPrefix+'" />').appendTo(this.$form);this.$macros.val(0)}}};XenForo.register("#MacroSelect","XenForo.Macros")}(jQuery,this,document);