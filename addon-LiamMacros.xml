<?xml version="1.0" encoding="utf-8"?>
<addon addon_id="LiamMacros" title="Post Macros" version_string="3.7.0" version_id="30700" url="https://xf-liam.com/products/post-macros.2/" install_callback_class="LiamW_Macros_Addon" install_callback_method="install" uninstall_callback_class="LiamW_Macros_Addon" uninstall_callback_method="uninstall">
  <admin_navigation>
    <navigation navigation_id="macros" parent_navigation_id="options" display_order="500000" link="macros" admin_permission_id="" debug_only="0" hide_no_children="0"/>
  </admin_navigation>
  <admin_permissions/>
  <admin_style_properties/>
  <admin_templates>
    <template title="liammacros_list"><![CDATA[<xen:title>{xen:phrase liammacros_macros}</xen:title>

<xen:topctrl>
	<a href="{xen:adminlink 'macros/new'}" class="button">+ {xen:phrase liammacros_new_macro}</a>
</xen:topctrl>

<xen:require css="filter_list.css" />
<xen:require js="js/xenforo/filter_list.js" />

<xen:if is="{$macros}">
	<xen:form action="{xen:adminlink 'macros'}" class="section">
		<h2 class="subHeading">
			<xen:include template="filter_list_controls" />
			{xen:phrase liammacros_macros}
		</h2>
		
		<ul class="FilterList Scrollable">
			<ol>
				<xen:foreach loop="$macros" value="$macro">
					<xen:listitem
						id="{$macro.id}"
						href="{xen:adminlink 'macros/edit', $macro}"
						label="{$macro.name}"
						delete="{xen:adminlink 'macros/delete', $macro}" />
				</xen:foreach>
			</ol>
		</ul>
	
		<p class="sectionFooter">{xen:phrase showing_x_of_y_items, 'count=<span class="FilterListCount">{xen:number $totalMacros}</span>', 'total={xen:number $totalMacros}'}</p>
	</xen:form>
<xen:else />
	<p>{xen:phrase liam_macros_no_macros}</p>
</xen:if>]]></template>
    <template title="liammacros_modify"><![CDATA[<xen:title><xen:if is="{$macro.macro_id}">{xen:phrase liammacros_edit}<xen:else />{xen:phrase liammacros_new}</xen:if></xen:title>

<xen:form action="{xen:adminlink 'macros/save'}" method="post" class="AutoValidator" data-redirect="on">

	<xen:textboxunit label="{xen:phrase liammacros_name}:" name="name" value="{$macro.name}" data-livetitletemplate="{xen:if {$macro.macro_id},
		'{xen:phrase liammacros_edit}: <em>%s</em>',
		'{xen:phrase liammacros_new}: <em>%s</em>'}" />
		
	<xen:textboxunit label="{xen:phrase liammacros_thread_title}:" name="thread_title" value="{$macro.thread_title}" />
	
	<xen:textboxunit label="{xen:phrase liammacros_content}:" name="content" hint="{xen:phrase macros_use_bbcode}" value="{$macro.content}" rows="5" />
	
	<xen:checkboxunit label="" name="lock_thread">
		<xen:option value="1" checked="{$macro.lock_thread}">{xen:phrase macros_lock_thread}</xen:option>
	</xen:checkboxunit>
	
	<xen:selectunit label="{xen:phrase macros_apply_prefix}:" name="apply_prefix">
		<xen:option value="0">({xen:phrase no})</xen:option>
		<xen:foreach loop="$prefixes" value="$prefix">
			<xen:option value="{$prefix.prefix_id}" selected="{$prefix.prefix_id} == {$macro.apply_prefix}">{$prefix.title}</xen:option>
		</xen:foreach>
	</xen:selectunit>
	
	<xen:checkboxunit label="{xen:phrase liammacros_ugps}:" name="usergroups">
		<xen:options source="$usergroups" checked="$macro.usergroups"/>
	</xen:checkboxunit>
	
	<xen:submitunit save="{xen:phrase save}" />
	<input type="hidden" name="macro_id" value="{$macro.macro_id}" />
</xen:form>]]></template>
  </admin_templates>
  <admin_template_modifications>
    <modification template="forum_edit" modification_key="macros_forum_edit" description="" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:option name="find_new" label="{xen:phrase include_forum_in_find_new_threads}" selected="{$forum.find_new}">
					<xen:hint>{xen:phrase if_disabled_messages_will_never_appear_in_find_new_threads}</xen:hint>
				</xen:option>]]></find>
      <replace><![CDATA[$0

				<xen:option name="allow_macros" label="{xen:phrase macros_allow_macros_forum}" selected="{$forum.allow_macros}">
					<xen:hint>{xen:phrase macros_allow_macros_explain}</xen:hint>
				</xen:option>]]></replace>
    </modification>
  </admin_template_modifications>
  <code_events/>
  <code_event_listeners>
    <listener event_id="container_public_params" execute_order="10" callback_class="LiamW_Macros_Addon" callback_method="containerParams" active="1" hint="" description="Add macros view permission to page container"/>
    <listener event_id="load_class_controller" execute_order="10" callback_class="LiamW_Macros_Addon" callback_method="extendForumAdminController" active="1" hint="XenForo_ControllerAdmin_Forum" description="XenForo_ControllerAdmin_Forum"/>
    <listener event_id="load_class_controller" execute_order="10" callback_class="LiamW_Macros_Addon" callback_method="extendAccountController" active="1" hint="XenForo_ControllerPublic_Account" description="XenForo_ControllerPublic_Account"/>
    <listener event_id="load_class_controller" execute_order="10" callback_class="LiamW_Macros_Addon" callback_method="extendThreadController" active="1" hint="XenForo_ControllerPublic_Thread" description="XenForo_ControllerPublic_Thread"/>
    <listener event_id="load_class_datawriter" execute_order="10" callback_class="LiamW_Macros_Addon" callback_method="extendForumDataWriter" active="1" hint="XenForo_DataWriter_Forum" description="XenForo_DataWriter_Forum"/>
    <listener event_id="load_class_datawriter" execute_order="10" callback_class="LiamW_Macros_Addon" callback_method="extendUserDataWriter" active="1" hint="XenForo_DataWriter_User" description="XenForo_DataWriter_User"/>
    <listener event_id="load_class_view" execute_order="10" callback_class="LiamW_Macros_Addon" callback_method="extendThreadCreateView" active="1" hint="XenForo_ViewPublic_Thread_Create" description="XenForo_ViewPublic_Thread_Create"/>
    <listener event_id="load_class_view" execute_order="10" callback_class="LiamW_Macros_Addon" callback_method="extendThreadReplyView" active="1" hint="XenForo_ViewPublic_Thread_Reply" description="XenForo_ViewPublic_Thread_Reply"/>
    <listener event_id="load_class_view" execute_order="10" callback_class="LiamW_Macros_Addon" callback_method="extendThreadViewView" active="1" hint="XenForo_ViewPublic_Thread_View" description="XenForo_ViewPublic_Thread_View"/>
    <listener event_id="load_class_view" execute_order="10" callback_class="LiamW_Macros_Addon" callback_method="extendConversationAddView" active="1" hint="XenForo_ViewPublic_Conversation_Add" description="XenForo_ViewPublic_Conversation_Add"/>
    <listener event_id="load_class_view" execute_order="10" callback_class="LiamW_Macros_Addon" callback_method="extendConversationReplyView" active="1" hint="XenForo_ViewPublic_Conversation_Reply" description="XenForo_ViewPublic_Conversation_Reply"/>
    <listener event_id="load_class_view" execute_order="10" callback_class="LiamW_Macros_Addon" callback_method="extendConversationViewView" active="1" hint="XenForo_ViewPublic_Conversation_View" description="XenForo_ViewPublic_Conversation_View"/>
    <listener event_id="template_create" execute_order="10" callback_class="LiamW_Macros_Addon" callback_method="templateCreate" active="1" hint="account_preferences" description="Add macros view permission to account preferences"/>
  </code_event_listeners>
  <cron/>
  <email_templates/>
  <email_template_modifications/>
  <optiongroups/>
  <permissions>
    <permission_groups>
      <permission_group permission_group_id="macro_permissions"/>
    </permission_groups>
    <permissions>
      <permission permission_group_id="macro_permissions" permission_id="can_create_staff_macros" permission_type="flag" depend_permission_id="use_staff_macros" default_value="unset" interface_group_id="macros" display_order="5"/>
      <permission permission_group_id="macro_permissions" permission_id="can_delete_staff_macros" permission_type="flag" default_value="unset" interface_group_id="macros" display_order="1000"/>
      <permission permission_group_id="macro_permissions" permission_id="can_edit_all_staff_macros" permission_type="flag" depend_permission_id="use_staff_macros" default_value="unset" interface_group_id="macros" display_order="6"/>
      <permission permission_group_id="macro_permissions" permission_id="can_use_macros" permission_type="flag" default_value="unset" interface_group_id="macros" display_order="1"/>
      <permission permission_group_id="macro_permissions" permission_id="max_macros" permission_type="integer" depend_permission_id="can_use_macros" default_value_int="0" interface_group_id="macros" display_order="2"/>
      <permission permission_group_id="macro_permissions" permission_id="use_staff_macros" permission_type="flag" depend_permission_id="can_use_macros" default_value="unset" interface_group_id="macros" display_order="4"/>
    </permissions>
    <interface_groups>
      <interface_group interface_group_id="macros" display_order="10"/>
    </interface_groups>
  </permissions>
  <phrases>
    <phrase title="add_macro" version_id="14" version_string="3.1.1"><![CDATA[Save Macro]]></phrase>
    <phrase title="admin_macros" version_id="14" version_string="3.1.1"><![CDATA[Admin Macros]]></phrase>
    <phrase title="admin_macros_description" version_id="14" version_string="3.1.1"><![CDATA[These macros have been defined by the administrator for your usergroup. They cannot be edited or deleted.]]></phrase>
    <phrase title="admin_navigation_macros" version_id="6" version_string="2.1"><![CDATA[Macro Definitions]]></phrase>
    <phrase title="controls_not_available" version_id="14" version_string="3.1.1"><![CDATA[Controls not available]]></phrase>
    <phrase title="delete_macro" version_id="0" version_string="1.0"><![CDATA[Delete Macro]]></phrase>
    <phrase title="edit_macro" version_id="0" version_string="1.0"><![CDATA[Edit Macro]]></phrase>
    <phrase title="insert_macro" version_id="0" version_string="1.0"><![CDATA[Insert Macro]]></phrase>
    <phrase title="liammacros_content" version_id="30608" version_string="3.6.8"><![CDATA[Macro Content]]></phrase>
    <phrase title="liammacros_edit" version_id="6" version_string="2.1"><![CDATA[Edit Macro Definition]]></phrase>
    <phrase title="liammacros_macros" version_id="6" version_string="2.1"><![CDATA[Macro Definitions]]></phrase>
    <phrase title="liammacros_name" version_id="30608" version_string="3.6.8"><![CDATA[Macro Title]]></phrase>
    <phrase title="liammacros_new" version_id="6" version_string="2.1"><![CDATA[New Macro Definition]]></phrase>
    <phrase title="liammacros_new_macro" version_id="6" version_string="2.1"><![CDATA[New Macro]]></phrase>
    <phrase title="liammacros_thread_title" version_id="30608" version_string="3.6.8"><![CDATA[Thread Title]]></phrase>
    <phrase title="liammacros_ugps" version_id="30608" version_string="3.6.8"><![CDATA[Permitted Usergroups]]></phrase>
    <phrase title="liam_macros_no_macros" version_id="30608" version_string="3.6.8"><![CDATA[No admin macros have been defined!]]></phrase>
    <phrase title="liam_post_macros" version_id="30606" version_string="3.6.6"><![CDATA[Post Macros]]></phrase>
    <phrase title="macros" version_id="0" version_string="1.0"><![CDATA[Macros]]></phrase>
    <phrase title="macros_admin_macros" version_id="30608" version_string="3.6.8"><![CDATA[Admin Macros]]></phrase>
    <phrase title="macros_allow_macros_explain" version_id="30501" version_string="3.5.1"><![CDATA[If disabled, users won't be able to use macros in this forum at all.]]></phrase>
    <phrase title="macros_allow_macros_forum" version_id="30501" version_string="3.5.1"><![CDATA[Allow macros in this forum]]></phrase>
    <phrase title="macros_apply_prefix" version_id="30608" version_string="3.6.8"><![CDATA[Apply Prefix]]></phrase>
    <phrase title="macros_delete_confirm" version_id="14" version_string="3.1.1"><![CDATA[Confirm deletion of macro]]></phrase>
    <phrase title="macros_description" version_id="30608" version_string="3.6.8"><![CDATA[These are the macros you created.]]></phrase>
    <phrase title="macros_hide_convo_ncnr" version_id="30606" version_string="3.6.6"><![CDATA[Hide macro drop-down on conversation create & reply pages]]></phrase>
    <phrase title="macros_hide_convo_qr" version_id="30606" version_string="3.6.6"><![CDATA[Hide macro drop-down on conversation page (quick reply)]]></phrase>
    <phrase title="macros_hide_new_thread_new_reply" version_id="30606" version_string="3.6.6"><![CDATA[Hide macro drop-down on thread create & reply pages]]></phrase>
    <phrase title="macros_hide_qr" version_id="30606" version_string="3.6.6"><![CDATA[Hide macro drop-down on thread page (quick reply)]]></phrase>
    <phrase title="macros_lock_thread" version_id="30608" version_string="3.6.8"><![CDATA[Lock Thread]]></phrase>
    <phrase title="macros_managing_macros" version_id="30304" version_string="3.3.4"><![CDATA[Managing macros]]></phrase>
    <phrase title="macros_not_allowed_to_use_that_macro" version_id="30608" version_string="3.6.8"><![CDATA[You are not allowed to use the requested macro!]]></phrase>
    <phrase title="macros_no_content" version_id="30603" version_string="3.6.3"><![CDATA[You must enter macro content!]]></phrase>
    <phrase title="macros_no_name" version_id="0" version_string="1.0"><![CDATA[Please enter a name for the macro!]]></phrase>
    <phrase title="macros_options" version_id="30200" version_string="3.2.0"><![CDATA[Macro Options]]></phrase>
    <phrase title="macros_other_macro" version_id="30304" version_string="3.3.4"><![CDATA[<i>This is a staff macro provided by {name}</i>]]></phrase>
    <phrase title="macros_own_staff_macro" version_id="30304" version_string="3.3.4"><![CDATA[<i>This is your own staff macro</i>]]></phrase>
    <phrase title="macros_thread_title" version_id="30401" version_string="3.4.1"><![CDATA[Thread Title]]></phrase>
    <phrase title="macros_user_macros" version_id="30608" version_string="3.6.8"><![CDATA[User Macros]]></phrase>
    <phrase title="macros_use_bbcode" version_id="30608" version_string="3.6.8"><![CDATA[Use BBCode]]></phrase>
    <phrase title="macros_vars" version_id="30304" version_string="3.3.4"><![CDATA[{threaduser} - The name of the thread author<br>
{threadname} - The title of the thread<br>
{forumname} - The title of the forum the thread has been posted in]]></phrase>
    <phrase title="macros_vars_available" version_id="30304" version_string="3.3.4"><![CDATA[The following variables are available:]]></phrase>
    <phrase title="macro_cant_add" version_id="0" version_string="1.0"><![CDATA[You cannot add new Macros!]]></phrase>
    <phrase title="macro_content" version_id="0" version_string="1.0"><![CDATA[Macro Content:]]></phrase>
    <phrase title="macro_doesnt_exist" version_id="14" version_string="3.1.1"><![CDATA[The macro you requested doesn't exist.]]></phrase>
    <phrase title="macro_edit" version_id="0" version_string="1.0"><![CDATA[Edit Macro: ]]></phrase>
    <phrase title="macro_inserted" version_id="0" version_string="1.0"><![CDATA[Macro Inserted]]></phrase>
    <phrase title="macro_name" version_id="0" version_string="1.0"><![CDATA[Macro Name: ]]></phrase>
    <phrase title="macro_name_placeholder" version_id="0" version_string="1.0"><![CDATA[Macro Name...]]></phrase>
    <phrase title="macro_no_macro" version_id="0" version_string="1.0"><![CDATA[Please enter a body for the macro!]]></phrase>
    <phrase title="macro_text_placeholder" version_id="0" version_string="1.0"><![CDATA[Macro Text...]]></phrase>
    <phrase title="macro_threadtitle_placeholder" version_id="30401" version_string="3.4.1"><![CDATA[Thead title...]]></phrase>
    <phrase title="new_macro" version_id="0" version_string="1.0"><![CDATA[Create Macro]]></phrase>
    <phrase title="permission_group_macro_permissions" version_id="0" version_string="1.0"><![CDATA[Macro Permissions]]></phrase>
    <phrase title="permission_interface_macros" version_id="0" version_string="1.0"><![CDATA[Macro Permissions]]></phrase>
    <phrase title="permission_macro_permissions_can_create_staff_macros" version_id="14" version_string="3.1.1"><![CDATA[Can create staff macros]]></phrase>
    <phrase title="permission_macro_permissions_can_delete_staff_macros" version_id="30304" version_string="3.3.4"><![CDATA[Can delete all staff macros]]></phrase>
    <phrase title="permission_macro_permissions_can_edit_all_staff_macros" version_id="14" version_string="3.1.1"><![CDATA[Can edit all staff macros]]></phrase>
    <phrase title="permission_macro_permissions_can_use_macros" version_id="0" version_string="1.0"><![CDATA[Can Use Macros]]></phrase>
    <phrase title="permission_macro_permissions_max_macros" version_id="30607" version_string="3.6.7"><![CDATA[Maximum Macros]]></phrase>
    <phrase title="permission_macro_permissions_use_staff_macros" version_id="5" version_string="2.0"><![CDATA[Can use staff macros]]></phrase>
    <phrase title="postmacros_error_deleting" version_id="14" version_string="3.1.1"><![CDATA[An error occurred while deleting the macro.]]></phrase>
    <phrase title="postmacros_master_name" version_id="14" version_string="3.1.1"><![CDATA[Select a macro to insert...]]></phrase>
    <phrase title="postmacros_only_delete_own" version_id="14" version_string="3.1.1"><![CDATA[You can only delete your own macros!]]></phrase>
    <phrase title="postmacros_usemacro_gone" version_id="14" version_string="3.1.1"><![CDATA[This action has been deprecated. Please remove all references to it. If you arrived here from a link, something is wrong - contact the forum administrator.]]></phrase>
    <phrase title="post_macros" version_id="14" version_string="3.1.1"><![CDATA[Post Macros]]></phrase>
    <phrase title="staff_macro" version_id="14" version_string="3.1.1"><![CDATA[Staff Macro]]></phrase>
    <phrase title="the_requested_macro_could_not_be_found" version_id="30608" version_string="3.6.8"><![CDATA[The requested macro could not be found.]]></phrase>
  </phrases>
  <route_prefixes>
    <route_type type="admin">
      <prefix original_prefix="macros" class="LiamW_Macros_Route_PrefixAdmin_Macros" build_link="data_only"/>
    </route_type>
    <route_type type="public">
      <prefix original_prefix="macros" class="LiamW_Macros_Route_Prefix_Macros" build_link="data_only"/>
    </route_type>
  </route_prefixes>
  <style_properties/>
  <templates>
    <template title="macros" version_id="30608" version_string="3.6.8"><![CDATA[<xen:require css="macros.css" />

<xen:title>{xen:phrase post_macros}</xen:title>
<xen:h1></xen:h1>

<xen:if is="{$canUseMacros}">
	<xen:topctrl>
		<a href="{xen:link 'macros/new'}" class="callToAction"><span>{xen:phrase new_macro}</span></a>
	</xen:topctrl>
</xen:if>

<xen:if hascontent="true">
	<div class="titleBar macroHeader">
		<h1>{xen:phrase macros_user_macros}</h1>
		<p id="pageDescription" class="muted baseHtml">{xen:phrase macros_description}</p>
	</div>

	<xen:contentcheck>
	<xen:foreach loop="$macros" value="$macro">	
		<ol class="section sectionMain">	
			<div class="subHeading">
				<h3 class="nodeTitle">
					{$macro.name} <xen:if is="{$macro.staff_macro}"><xen:if is="{$visitor.user_id} == {$macro.user_id}"> - {xen:phrase macros_own_staff_macro}<xen:else /> - {xen:phrase macros_other_macro, 'name={$macro.username}'}</xen:if></xen:if>
				</h3>
			</div>
	
			<div class="primaryContent">
				<p class="muted">{xen:phrase macros_thread_title}: {xen:raw $macro.thread_title}</p>
			</div>
	
			<div class="primaryContent">
				{xen:raw $macro.content}
			</div>
	
			<div class="primaryContent">
				<p class="muted">{xen:phrase macros_apply_prefix}: {xen:if $macro.apply_prefix, '{$macro.prefix_title}', '{xen:phrase no}'}. {xen:phrase macros_lock_thread}: {xen:if $macro.lock_thread, '{xen:phrase yes}', '{xen:phrase no}'}</p>
			</div>
	
			<div class="sectionFooter macroControls">
				<xen:if is="{$macro.canDelete}"><span><a href="{xen:link 'macros/delete', $macro}" class="OverlayTrigger">{xen:phrase delete_macro}</a></span></xen:if>
				<xen:if is="{$macro.canEdit}"><span><a href="{xen:link 'macros/edit', $macro}">{xen:phrase edit_macro}</a></span></xen:if>
				
				<xen:if is="!{$macro.canEdit} && !{$macro.canDelete}">
					<i>{xen:phrase controls_not_available}</i>
				</xen:if>
			</div>
		</ol>	
	</xen:foreach>
	</xen:contentcheck>
</xen:if>

<xen:if hascontent="true">
	<div class="titleBar macroHeader">
		<h1>{xen:phrase admin_macros}</h1>
		<p id="pageDescription" class="muted baseHtml">{xen:phrase admin_macros_description}</p>
	</div>

	<xen:contentcheck>
	<xen:foreach loop="$adminMacros" value="$adminMacro">
		<ol class="section sectionMain">
	
			<div class="subHeading">
				<h3 class="nodeTitle">
					{$adminMacro.name}
				</h3>
			</div>
	
			<div class="primaryContent">
				<p class="muted">{xen:phrase macros_thread_title}: {xen:raw $adminMacro.thread_title}</p>
			</div>
			
			<div class="primaryContent">
				{xen:raw $adminMacro.content}
			</div>
			
			<div class="primaryContent">
				<p class="muted">{xen:phrase macros_apply_prefix}: {xen:if $adminMacro.apply_prefix, '{$adminMacro.prefix_title}', '{xen:phrase no}'}. {xen:phrase macros_lock_thread}: {xen:if $adminMacro.lock_thread, '{xen:phrase yes}', '{xen:phrase no}'}</p>
			</div>
	
			<div class="sectionFooter macroControls">
				<i>{xen:phrase controls_not_available}.</i>
			</div>
	
		</ol>
	</xen:foreach>
	</xen:contentcheck>
</xen:if>]]></template>
    <template title="macros.css" version_id="14" version_string="3.1.1"><![CDATA[.macroHeader h1 { padding-top: 10px; } 

.macroControls span, .macroControls i {
	float: right;
	padding-right: 10px;
}]]></template>
    <template title="macros_account_link" version_id="30606" version_string="3.6.6"><![CDATA[<xen:if is="{$canViewMacros}"><li><a href="{xen:link full:macros}">{xen:phrase macros}</a></li></xen:if>]]></template>
    <template title="macros_confirm_delete" version_id="14" version_string="3.1.1"><![CDATA[<xen:title>{xen:phrase delete_macro}</xen:title>

<form action="{xen:link 'macros/delete', $macro}" method="post" class="xenForm deleteConfirmForm formOverlay">
	<p>{xen:phrase macros_delete_confirm}: <b><a href="{xen:link macros/edit, $macro}">{$macro.name}</a></b></p>
	
	<dl class="ctrlUnit submitUnit">
		<dt></dt>
		<dd>
			<input type="submit" value="{xen:phrase delete_macro}" class="button primary" accesskey="s">
			<input type="reset" class="button OverlayCloser" value="{xen:phrase cancel}">
		</dd>
	</dl>
		
	<input type="hidden" name="_xfConfirm" value="1">	
	<input type="hidden" name="_xfToken" value="{$visitor.csrf_token_page}" />
</form>]]></template>
    <template title="macros_modify" version_id="30608" version_string="3.6.8"><![CDATA[<xen:if is="{$macro.macro_id}">
	<xen:title>{xen:phrase macro_edit} {$macro.name}</xen:title>
<xen:else />
	<xen:title>{xen:phrase new_macro}</xen:title>
</xen:if>

<xen:if is="{$macro.macro_id}">
	<xen:navigation>
		<xen:breadcrumb href="{xen:link 'full:macros'}">{xen:phrase macros}</xen:breadcrumb>
		<xen:breadcrumb href="{xen:link 'full:macros'}">{$macro.name}</xen:breadcrumb>
	</xen:navigation>
<xen:else />
	<xen:navigation>
		<xen:breadcrumb href="{xen:link 'full:macros'}">{xen:phrase macros}</xen:breadcrumb>
	</xen:navigation>
</xen:if>

<form action="{xen:link 'macros/save'}" method="post" class="xenForm Preview AutoValidator" data-redirect="on"
	data-previewUrl="{xen:link 'macros/preview'}">
	<fieldset>
				
		<dl class="ctrlUnit fullWidth surplusLabel">
			<dt><label for="ctrl_name">{xen:phrase name}</label></dt>
			<dd><input id="ctrl_name" type="text" name="name" class="textCtrl titleCtrl" placeholder="{xen:phrase macro_name_placeholder}" value="{$macro.name}" data-liveTitleTemplate="<xen:if is="{$macro.macro_id}">{xen:phrase edit_macro}<xen:else />{xen:phrase new_macro}</xen:if>: <em>%s</em>"></dd>
		</dl>
		
		<dl class="ctrlUnit fullWidth surplusLabel">
			<dt><label for="ctrl_thread_title">{xen:phrase title}:</label></dt>
			<dd><input type="text" name="thread_title" class="textCtrl" placeholder="{xen:phrase macro_threadtitle_placeholder}" value="{$macro.thread_title}"></dd>
		</dl>
		
		<dl class="ctrlUnit fullWidth">
			<dt></dt>
			<dd>{xen:raw $editorTemplate}</dd>
		</dl>
		
		<xen:if is="{$visitor.is_staff} OR {$visitor.is_moderator} OR {$visitor.is_admin}">
			<dl class="ctrlUnit">
				<dt></dt>
				<dd>
					<label><input type="checkbox" value="1" name="lock_thread" {xen:if $macro.lock_thread, 'checked="checked"'}/> {xen:phrase macros_lock_thread}</label>
				</dd>
			</dl>
			
			<dl class="ctrlUnit">
				<dt><label for="ctrl_apply_prefix">{xen:phrase macros_apply_prefix}:</label></dt>
				<dd>
					<select id="ctrl_apply_prefix" class="textCtrl" name="apply_prefix">
						<option value="0">({xen:phrase no})</option>
						<xen:foreach loop="$prefixes" value="$prefix">
							<option value="{$prefix.prefix_id}" {xen:if '{$macro.apply_prefix} == {$prefix.prefix_id}', 'selected=selected'}>{$prefix.title}</option>
						</xen:foreach>
					</select>
				</dd>
			</dl>
		</xen:if>
			
		<xen:if is="{$createStaffMacro}">
			<dl>
				<dd><input type="checkbox" id="ctrl_staff_macro" name="staff_macro" value="true" <xen:if is="{$macro.staff_macro}">checked="checked"</xen:if> <xen:if is="{$disableStaffMacro}">disabled="true"</xen:if>> <label for="ctrl_staff_macro">{xen:phrase staff_macro}</label></dd>
				<dt></dt>
			</dl>
		</xen:if>					
		
		<input type="hidden" name="macro_id" value="{$macro.macro_id}" />
		<input type="hidden" name="_xfToken" value="{$visitor.csrf_token_page}" />
	</fieldset>
	
	<dl class="ctrlUnit submitUnit">
		<dt></dt>
		<dd>
			<input type="submit" value="{xen:phrase add_macro}" class="button primary" accesskey="s">
			<input type="button" value="{xen:phrase preview}..." class="button PreviewButton JsOnly" />
		</dd>
	</dl>
	
	<dl class="ctrlUnit">
		<dt>{xen:phrase macros_vars_available}</dt>
		<dd>{xen:phrase macros_vars}</dd>
	</dl>
</form>]]></template>
    <template title="macros_options" version_id="30606" version_string="3.6.6"><![CDATA[<xen:if is="{$canViewMacros}">
	<h3 class="sectionHeader">{xen:phrase liam_post_macros}</h3>
	
	<dl class="ctrlUnit">
		<dt></dt>
		<dd>
			<ul>
				<li>
					<input type="checkbox" value="1" id="macros_hide_qr" name="macros_hide_qr" {xen:checked {$visitor.macros_hide_qr}} />
					<label for="macros_hide_qr">{xen:phrase macros_hide_qr}</label>
				</li>				
				<li>
					<input type="checkbox" value="1" id="macros_hide_ntnr" name="macros_hide_ntnr" {xen:checked {$visitor.macros_hide_ntnr}} />		
					<label for="macros_hide_ntnr">{xen:phrase macros_hide_new_thread_new_reply}</label>
				</li>			
				<li>
					<input type="checkbox" value="1" id="macros_hide_convo_qr" name="macros_hide_convo_qr" {xen:checked {$visitor.macros_hide_convo_qr}} />
					<label for="macros_hide_convo_qr">{xen:phrase macros_hide_convo_qr}</label>
				</li>		
				<li>
					<input type="checkbox" value="1" id="macros_hide_convo_ncnr" name="macros_hide_convo_ncnr" {xen:checked {$visitor.macros_hide_convo_ncnr}} />
					<label for="macros_hide_convo_ncnr">{xen:phrase macros_hide_convo_ncnr}</label>		
				</li>
			</ul>
		</dd>
	</dl>
</xen:if>]]></template>
    <template title="macros_preview" version_id="30608" version_string="3.6.8"><![CDATA[<div class="section">
	<h3 class="subHeading">{xen:phrase preview}</h3>
	<div class="messageText primaryContent baseHtml">{xen:raw $contentParsed}</div>
</div>]]></template>
    <template title="macros_select" version_id="30608" version_string="3.6.8"><![CDATA[<xen:require js="js/macros/macros.{xen:if $debug, '', 'min.'}js" />
	
<xen:if is="{$canViewMacros}">
	<span {xen:if '{$qreply}', 'style="float: left;"'}>
		<select name="macros" class="textCtrl" id="MacroSelect" {xen:if '!{$qreply}', 'style="width: 100%;"'}>
			<option value="0">{xen:phrase postmacros_master_name}</option>
			<xen:if hascontent="true">
				<optgroup label="{xen:phrase macros_user_macros}">
					<xen:contentcheck>
						<xen:foreach loop="$userMacros" value="$userMacro">
							<option value="{$userMacro.macro_id}" data-type="user">{$userMacro.name}</option>
						</xen:foreach>
					</xen:contentcheck>
				</optgroup>
			</xen:if>
			<xen:if hascontent="true">
				<optgroup label="{xen:phrase macros_admin_macros}">
					<xen:contentcheck>
						<xen:foreach loop="$adminMacros" value="$adminMacro">
							<option value="{$adminMacro.macro_id}" data-type="admin">{$adminMacro.name}</option>
						</xen:foreach>
					</xen:contentcheck>
				</optgroup>
			</xen:if>
		</select>
	</span>
</xen:if>]]></template>
  </templates>
  <public_template_modifications>
    <modification template="conversation_add" modification_key="add_drop_down_create" description="" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[{xen:raw $editorTemplate}</dd>]]></find>
      <replace><![CDATA[<xen:include template="macros_select" />$0]]></replace>
    </modification>
    <modification template="conversation_add" modification_key="converdation_new_macros" description="" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<form action="{xen:link 'conversations/insert'}" method="post" class="xenForm Preview AutoValidator"]]></find>
      <replace><![CDATA[$0 id="main_form"]]></replace>
    </modification>
    <modification template="conversation_reply" modification_key="conversationreplymacros" description="" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<form action="{xen:link 'conversations/insert-reply', $conversation}" method="post" class="xenForm Preview"]]></find>
      <replace><![CDATA[$0 id="main_form"]]></replace>
    </modification>
    <modification template="conversation_reply" modification_key="convoreply_macros" description="" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[{xen:raw $editorTemplate}</dd>]]></find>
      <replace><![CDATA[<xen:include template="macros_select" />$0]]></replace>
    </modification>
    <modification template="account_preferences" modification_key="liam_macros_account_preferences" description="" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:include template="custom_fields_edit" />]]></find>
      <replace><![CDATA[<xen:include template="macros_options" />
$0]]></replace>
    </modification>
    <modification template="thread_create" modification_key="macros_select" description="" execution_order="1" enabled="1" action="preg_replace">
      <find><![CDATA[/<form action="{xen:link 'forums\/add-thread', \$forum}"(.*?)data-redirect="on"
/is]]></find>
      <replace><![CDATA[$0id="main_form"]]></replace>
    </modification>
    <modification template="navigation_visitor_tab" modification_key="macrosaccountlink" description="Adds macros link to drop down" execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[<xen:if is="{$canEditSignature}"><li><a href="{xen:link account/signature}">{xen:phrase signature}</a></li></xen:if>]]></find>
      <replace><![CDATA[$0
<xen:include template="macros_account_link" />]]></replace>
    </modification>
    <modification template="thread_create" modification_key="macrosdropdowntcreate" description="" execution_order="2" enabled="1" action="str_replace">
      <find><![CDATA[{xen:raw $editorTemplate}</dd>]]></find>
      <replace><![CDATA[<xen:include template="macros_select" />$0]]></replace>
    </modification>
    <modification template="quick_reply" modification_key="macrosqreply" description="" execution_order="100" enabled="1" action="str_replace">
      <find><![CDATA[<input type="submit" class="button primary" value="{xen:phrase post_reply}" accesskey="s" />]]></find>
      <replace><![CDATA[<xen:include template="macros_select">
<xen:set var="$qreply">1</xen:set>
</xen:include>
$0]]></replace>
    </modification>
    <modification template="thread_reply" modification_key="macrosthreadreplydropdown" description="" execution_order="2" enabled="1" action="str_replace">
      <find><![CDATA[<dt><label for="ctrl_message">{xen:phrase message}:</label></dt>
			<dd>]]></find>
      <replace><![CDATA[$0
<xen:include template="macros_select" />]]></replace>
    </modification>
    <modification template="footer" modification_key="post_macros_branding" description="Branding. If you have a valid branding removal license, you may disable this." execution_order="10" enabled="1" action="str_replace">
      <find><![CDATA[{xen:phrase extra_copyright}]]></find>
      <replace><![CDATA[| <a href="https://xf-liam.com" target="_blank" class="concealed">Post Macros <span>&copy 2013-2015</span></a> $0]]></replace>
    </modification>
    <modification template="thread_reply" modification_key="thread_reply_macros" description="" execution_order="1" enabled="1" action="preg_replace">
      <find><![CDATA[/<form action="{xen:link 'threads\/add-reply', \$thread}" method="post"(.*?)/is]]></find>
      <replace><![CDATA[$0id="main_form"]]></replace>
    </modification>
  </public_template_modifications>
  <bb_code_media_sites/>
  <bb_codes/>
</addon>
